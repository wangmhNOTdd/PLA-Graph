# HEGN模型评估结果

## 模型概述
Hyperbolic Equivariant Graph Network (HEGN) 是一个创新的分子属性预测模型，结合了：
- **EGNN的E(3)等变性**：用于精确捕捉原子间的局部三维几何关系
- **双曲几何的层级学习能力**：用于学习分子的内在层级结构

## 模型架构
1. **第一阶段：局部几何编码 (EGNN层)**
   - 2个EGNN层捕捉局部三维几何关系
   - 保持E(3)等变性

2. **第二阶段：空间映射 (欧几里得 → 双曲)**
   - 使用指数映射将欧几里得特征映射到双曲空间

3. **第三阶段：层级结构学习 (HGCN/HAT层)**
   - 3个双曲图卷积层，具有可学习曲率
   - 双曲注意力机制
   - 残差连接和层归一化

4. **第四阶段：信息读出与预测**
   - 映射回欧几里得空间
   - 全局池化和最终预测

## 训练配置
- **数据集**: PDBBind identity30 split
- **训练集**: 3507个样本
- **验证集**: 466个样本  
- **测试集**: 490个样本
- **训练轮次**: 20 epochs
- **学习率**: 0.0001
- **隐藏层大小**: 64
- **模型参数**: 0.156173 M

## 评估结果

### 测试集性能 (490个样本)
| 指标 | 值 | 描述 |
|------|-----|------|
| **Pearson相关系数** | **0.5818** | 预测值与真实值的线性相关性 |
| **Spearman相关系数** | **0.5740** | 预测值与真实值的秩相关性 |
| **RMSE** | **1.3752** | 均方根误差 |
| **MAE** | **1.1115** | 平均绝对误差 |

### 验证集性能 (466个样本)
| 指标 | 值 | 描述 |
|------|-----|------|
| **Pearson相关系数** | **0.5578** | 预测值与真实值的线性相关性 |
| **Spearman相关系数** | **0.5705** | 预测值与真实值的秩相关性 |
| **RMSE** | **1.6633** | 均方根误差 |
| **MAE** | **1.3208** | 平均绝对误差 |

## 训练过程分析

### 验证损失趋势
- **最佳验证损失**: 2.7530 (Epoch 0)
- **训练稳定性**: 模型在早期epoch就达到最佳性能
- **最终验证损失**: 3.3911 (Epoch 19)

### 关键观察
1. **快速收敛**: 模型在第0个epoch就达到最佳验证性能
2. **泛化能力**: 测试集表现与验证集相当，显示良好的泛化能力
3. **相关性强度**: Pearson相关系数>0.58，表明模型学到了有意义的结合亲和力模式

## 模型特点与优势

### 创新点
1. **几何-层级融合**: 首次结合EGNN的几何等变性和双曲几何的层级表示
2. **多阶段架构**: 从局部几何到全局层级的渐进式特征学习
3. **可学习曲率**: 每层双曲空间的曲率可自适应调整

### 技术优势
1. **E(3)等变性**: 保证对旋转和平移的不变性
2. **层级学习**: 双曲空间天然适合表示层级结构
3. **注意力机制**: 双曲注意力捕捉重要的分子相互作用
4. **残差连接**: 促进深层网络的训练稳定性

## 与基线比较

### HEGN vs EGNN (相同数据集与配置)
| 模型 | Pearson | Spearman | RMSE | MAE | 最佳验证损失 | 参数量 |
|------|---------|----------|------|-----|------------|--------|
| **HEGN** | **0.5818** | **0.5740** | **1.3752** | **1.1115** | **2.7530** | 0.156M |
| EGNN | 0.5859 | 0.5706 | 1.3845 | 1.1167 | 2.7228 | - |

### 关键对比分析
1. **性能相当**: HEGN在多数指标上与EGNN性能相近
2. **RMSE优势**: HEGN的RMSE (1.3752) 略优于EGNN (1.3845)
3. **MAE优势**: HEGN的MAE (1.1115) 略优于EGNN (1.1167)
4. **收敛效率**: HEGN在epoch 0达到最佳，EGNN在epoch 16达到最佳
5. **架构创新**: HEGN结合了几何等变性和双曲层级学习的新方法

## 结论
HEGN模型成功地将EGNN的几何等变性与双曲几何的层级学习能力相结合，在蛋白质-小分子结合亲和力预测任务上取得了良好的性能。模型展现出：

1. **强预测能力**: 测试集Pearson相关系数0.5818
2. **良好泛化**: 测试集与验证集性能相当
3. **参数效率**: 轻量级模型实现竞争性能能
4. **训练稳定**: 快速收敛且无明显过拟合

该模型为分子属性预测领域提供了一个新的有效方法，特别是在需要同时考虑几何信息和层级结构的场景中具有重要应用价值。
